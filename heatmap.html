<!doctype html>
<html lang="en">
    <head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-81871818-3"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'UA-81871818-3');
        </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=AM_CHTML"></script>


    <link rel="stylesheet" type="text/css" href="style.css">
        <link href="https://fonts.googleapis.com/css?family=Cardo|IBM+Plex+Mono&display=swap" rel="stylesheet">
        <meta name="viewport" content="width=450" />
        <link rel="icon" href="icon.png" />
        <title>Generating Choropleth Maps</title>
    </head>
    <body>
        
    <div id="blogbox">
        <h2>Generating Choropleth Maps</h2>
        <text class="cap3">
        Stephen Duncanson<br>
        December 28, 2019</text>
        <p>Another project of mine that started during my internship at RACE Coastal Engineering was creating kml polygonal heatmaps from lists of <text class="icode">(lat,long)</text> coordinates. An example of this is shown below using randomly generated coordinates: <text class="icode">random.uniform(41,42), random.uniform(-71,-72)</text> and 1-mile side lengths. </p>
        <img src="heatmap.png"class="photo">
        <text class="cap">Polygonal heatmap generated from randomly generated latitude and longitude pairs around CT. Source: <a href="https://github.com/sdunc/heatmaps/blob/master/heat.py"target="_blank">heat.py</a>. kml file: <a href="https://github.com/sdunc/heatmaps/blob/master/test.kml"target="_blank">test.kml</a></text>
        <p>This heatmap program was heavily inspired by Mark Polczynski and Michael Polczynski's paper: <a href="https://www.researchgate.net/publication/260839255_A_Microsoft_VBA_Application_for_Generating_Heat_Maps"target="_blank">A Microsoft VBA Application for Generating Heat Maps</a>, in which they analyze the 17th century frontier between the Polish/Lithuanian Commonwealth and the Ottoman Empire. I reimplemented their algorithm in python for increased speed and flexibility.</p>
        
        <p>In both cases the steps are the same:
            <ol>
        <li>Generate a grid of geographical regions</li>
        <li>Calculate a `g` grid attribute value for each square</li>
        <li>Build KML polygon layer, coloring squares accoridng to their `g` values</li>
        </ol></p>
        
        <p>Each 'square' has a `g` value defined as: </p>
            <center>
            `g_{i} = sum_(j=1)^N p_{j} e^{-\frac{d_{ij}^{2}}{r^{2}}`
            </center>
        <p>Where `N` is the number of squares on the map, `p_{j}` is a constant denoting the <i>weight</i> of the point (in the case of the heatmap `p_{j} = 1`), `d_{ij} ` is the distance between the center of the square and the set of coordinates, and `r^{2}` is what the paper calls the <i>grid range</i> which changes the look of the heatmap. </p>
        <p>Eventually this will be given proper treatment, for now it serves to illustrate the power of KML. There are myriad improvements which could be done to my program (a kdtree for starters). </p>

      <p>To be continued...</p>


  <h4><a href="http:\\www.stephlog.com">Home</a></h4>

        </div>
    </body>
</html>

    

